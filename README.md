# Protein Structure Generation Using Variational Autoencoder (VAE)

This repository presents an  implementation of a Variational Autoencoder (VAE) tailored for the generation and analysis of protein structures. The documentation provided here outlines the conceptual foundation, technical implementation, and operational guidelines for utilizing this framework.

## Project Overview

The VAE in this repository is designed to process molecular coordinate data, enabling the reconstruction of protein structures and the computation of advanced loss metrics. Additionally, the model facilitates the generation of novel protein structures, making it a versatile tool for computational protein modeling.

### Key Features

- Advanced VAE architecture optimized for high-dimensional protein structure data.
- Seamless processing of protein coordinate files for downstream applications.
- Comprehensive loss functions, including reconstruction loss and Ramachandran angle loss, for precise model training.
- Tools for generating, reconstructing, and visualizing protein conformations.

## File Descriptions

### 1. `Model.py`

This file defines the core architecture of the VAE. Key components include:

- **Encoder**: Projects protein coordinate data into a compressed latent space representation.
- **Reparameterization Module**: Implements the reparameterization trick to introduce controlled stochasticity in the latent space.
- **Decoder**: Reconstructs protein coordinate data from latent embeddings.
- **Adjustable Sampling Temperature**: Allows for fine-grained control over the latent space during sampling, aiding in protein structure diversity.

### 2. `main.py`

This script orchestrates the entire workflow, including data preprocessing, model training, testing, and protein structure generation. Notable features:

- **Data Preprocessing**: Efficiently processes protein coordinate data into tensors suitable for VAE training.
- **Training Workflow**: Implements iterative training with dynamic loss computation.
- **Evaluation Pipeline**: Quantifies model performance through reconstruction accuracy and RMSD calculations.
- **Protein Generation**: Utilizes the trained VAE to produce novel protein conformations.
- **Visualization Tools**: Supports PDB file generation and RMSD analysis against reference protein structures.

### 3. `loss_functions.py`

This module contains advanced loss functions critical for VAE training. Key functionalities include:

- **Reconstruction Loss**: Measures fidelity in reconstructed protein coordinates.
- **Ramachandran Angle Loss**: Captures discrepancies in predicted and actual backbone torsional angles.
- **Weighted MSE Loss**: Implements atom-type specific weighting for nuanced error calculations.
- **FAPE Loss**: Computes the Frame Aligned Point Error to evaluate structural consistency.



## Core Functions and Methodologies

### Loss Functions

- **`loss_function`**: Integrates reconstruction, KL divergence, and Ramachandran angle losses into a unified training objective.
- **`adjust_weights`**: Dynamically tunes loss weights to optimize training progression.

### VAE Components

- **`encode`**: Maps protein coordinates to a latent representation.
- **`decode`**: Reconstructs protein structures from the latent space.
- **`reparameterize`**: Implements stochastic sampling with control over variability through temperature scaling.

### Protein Data Processing

- **`process_xyz_file_optimized`**: Efficiently parses molecular coordinate files, transforming them into standardized tensors.
- **`replace_coordinates`**: Substitutes atom coordinates in PDB files with those generated by the model for visualization.


